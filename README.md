# AI-teaching

Эта инструкция написаны для того, чтобы любой желающий мог повторить наш эксперимент и обучить ИИ, способный быстро и точно обнаружить нужный объект на видео.  
Для обучения моделей мы использовали ресурсы Google colab, поэтому требования к аппаратуре довольно низкие. Любой современный ноутбук легко позволит вам выполнить все пункты. Однако для корректной работы потребуется стабильное подключение к Интернету.
Эти инструкции были написаны для пользователей, не имеющих опыта работы с ИИ. Если вы относитесь к числу новичков, просто выполняйте шаги по порядку.
Примечание: Предполагается, что на момент начала у вас уже есть набор данных из ~ 1000 немаркированных кадров.

## 1.	Разметка набора данных

1.1.	Установка RemoApp

RemoApp - это приложение, в котором будет производиться разметка изображений. Установка производится через командную строку.

Сначала необходимо установить библиотеку:
pip install remo

Затем инициализировать и запустить:
python -m remo_app init
python -m remo_app

Если установка не удалась, попробуйте:
apt-get update
pip install psycopg2==2.8.6

а затем повторите команды выше.

## 1.2.	Обработка изображений

Сначала создайте набор данных, нажав кнопку "CREATE DATASET" в левом верхнем углу окна программы (рис. 1). Если пустое окно набора данных (рис. 2) не появилось, нажмите кнопку "Перезагрузка" на вкладке "Вид" на панели инструментов.

 
рис. 1
 
рис. 2

После создания первого набора данных вы можете авторизоваться в Remo. Кнопку, которую нужно нажать для начала авторизации, вы можете найти в левом верхнем углу. Если после авторизации ваш ник не отображается в окне кабинета, нажмите на кнопку "Перезагрузить" еще раз.

Давайте разметим изображения. Щелкните на пустом наборе данных, который был создан ранее, а затем нажмите "ДОБАВИТЬ ДАННЫЕ". На данном этапе у вас еще нет аннотаций, поэтому на следующем шаге выберите "Добавить только изображение". Затем, используя открывшееся окно, введите подготовленные изображения (можно загрузить неархивированную папку). 

После загрузки всех изображений вы можете приступить к их аннотированию. Нажмите кнопку "АННОТИРОВАТЬ" в левом верхнем углу (рис. 3).

 
рис. 3

Назовите набор данных так, как вы хотите. В разделе "Выберите задачу" выберите "Сегментация экземпляров". Вы можете добавить класс (Имя объекта для разметки) сейчас или позже, во время самой разметки. Следующий шаг - снова нажать на "ANNOTATE".

Теперь мы можем перейти непосредственно к разметке. В правом верхнем углу выберите инструмент "Нарисовать многоугольник" (рис. 4). Теперь обрисуйте объект и закройте контур. Примечание: Избегайте наложения соседних точек и замыкайте цепь только после как минимум трех звеньев. В противном случае приложение выдаст ошибку и перестанет работать.
 
рис. 4
Если вы не создали класс при задании параметров аннотации, вы можете создать его в процессе разбиения. После закрытия контура появится окно, в котором нужно выбрать, какой маркер принадлежит выделенной области. Там же будет опция "Новый класс". 

## 1.3.	Экспорт аннотации
После разметки всех изображений вернитесь на главную страницу (Здесь отображаются все существующие наборы данных). Раскройте меню, нажав на кнопку в левом верхнем углу набора данных, и найдите в списке пункт "Экспортировать аннотацию". Формат аннотации должен быть "COCO JSON". В дополнительных опциях снимите флажок с опции "Включать изображения без аннотации".		
Загруженный файл будет содержать аннотации для каждого изображения. 
Назовите этот файл "Labels".	

## 2.	Модель для сегментации

## 2.1.	Предварительный отбор

Для обучения полноценного ИИ не хватает 1000 изображений, а вручную маркировать 6000-7000 слишком сложно. Поэтому дальнейшая обработка будет производиться с помощью модели.
 
Мы создадим и обучим ее в Google Colab: https://colab.research.google.com/drive/1q-OcIaU-9hJRWEGtpJ3kH8G7hruUYkXz#scrollTo=-sv6XYkpWzNx. 
Так же код лежит в папке ANNOTATING.

Скопируйте google colab на свой google drive. Создайте аналогичную структуру в корневой папке google drive:

 

Загрузите кадры вашего набора данных в папку:  VisionProject/Dataset/Data/
Затем загрузите файл "Labels.json", который у вас был после предыдущих шагов.  "NewLabels" может быть копией "Labels". 

Эта структура используется исключительно для удобства использования google colab. Вы можете использовать свою собственную структуру, если хотите, но вам придется изменить пути к файлам.

## 2.2.	Обучение модели

Если вы правильно выполнили предыдущие шаги, вам остается только запускать блоки кода один за другим. В противном случае необходимо обратить внимание на пути к файлам. 
